<!DOCTYPE html>
{% load static %}
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
        href="https://fonts.googleapis.com/css2?family=Chocolate+Classical+Sans&family=Cuprum:ital,wght@0,400..700;1,400..700&family=M+PLUS+1p:wght@100;300;400;500;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static "favicon/apple-touch-icon.png" %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static "favicon/favicon-32x32.png" %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static "favicon/favicon-16x16.png" %}">
    <link rel="manifest" href="{% static "favicon/site.webmanifest" %}">
    <link rel="mask-icon" href="{% static "favicon/safari-pinned-tab.svg" %}" color="#5bbad5">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <meta name="apple-mobile-web-app-title" content="AnonLoader">
    <meta name="application-name" content="AnonLoader">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <title>AnonLoader</title>
</head>

<body>
    <div class="container main-container">
        <div class="row justify-content-center">
            <!-- Основной контент -->
            <div class="col-lg-7 col-md-9 col-sm-12 mb-4 main-content">
                
                <section class="d-flex flex-column flex-lg justify-content-center-row gap-3 mt-4">
                    {% for banner in ads_banners %}
                        {% if banner.is_active %}
                        <a target="_blank" rel="noopener noreferrer" href="{{banner.link}}">
                            <img alt="{{banner.title}}" loading="lazy" width="1200" height="600" decoding="async" 
                                src="{{ banner.image.url }}" class="img-fluid" style="color: transparent;">
                        </a>
                        {% endif %}
                    {% endfor %}
                </section>
                <!-- Ключ -->
                <div class="container mt-4">
                    <h1>Введите Ваш ключ:</h1>
                    <!-- Форма для ввода ключа -->
                    <form method="post" id="fileForm">
                        {% csrf_token %}
                        {{ form.unique_key.label_tag }}
                        {{ form.unique_key }}
                        <button type="submit" class="btn btn-primary w-100 mt-3">Показать файл</button>
                    </form>
    
                    {% if error_message %}
                    <p class="status-message alert alert-danger mt-3">{{ error_message }}</p>
                    {% endif %}
                </div>
                <!-- Файл -->
                <div class="container mt-4">
                    <h1>Загрузите файл:</h1>
                    <!-- Форма для загрузки файла -->
                    <form method="post" enctype="multipart/form-data" id="uploadForm">
                        {% csrf_token %}
                        <label for="file_input">{{ file_form.file.label_tag }}</label>
                        {{ file_form.file }}
    
                        <label for="file_lifetime" class="mt-3">Выберите срок жизни файла:</label>
                        <select id="file_lifetime" name="file_lifetime" class="form-select select-lifetime">
                            <option value="one_time">Одноразовая ссылка</option>
                            <option value="1_day">1 день</option>
                            <option value="3_days">3 дня</option>
                            <option value="7_days">7 дней</option>
                        </select>
    
                        <p id="oneTimeNotice" class="notice mt-3" style="display: none;">
                            "Одноразовая ссылка" - это когда файл может быть открыт и скачан только один раз.
                        </p>
    
                        <button type="submit" class="btn btn-success w-100 mt-3">Загрузить файл</button>
                    </form>
                    <div id="loadingIndicator" class="loading-indicator" style="display: none;">
                        <p>Отправка файла, пожалуйста, подождите...</p>
                        <div class="loader">
                        </div>
                    </div>
    
                    <div id="uploadStatus" class="status-message mt-3">
                        {% if error_file_message %}
                        <p class="alert alert-danger">{{ error_file_message }}</p>
                        {% endif %}
                    </div>
                    
                </div>
                <!-- Контакты -->
                <div class="container mt-4">
                    <h2>Контакты</h2>
                    <ul class="list-unstyled">
                        <li>
                            <a href="https://t.me/AnonLoader_bot" target="_blank">
                                <i class="fab fa-telegram"></i> AnonLoader | Анонимный файлообменник
                            </a>
                        </li>
                        <li>
                            <a href="https://t.me/AnonLoaderSupport_bot" target="_blank">
                                <i class="fab fa-telegram"></i> AnonSupport | Поддержка
                            </a>
                        </li>
                    </ul>
                </div>
                
            </div>


        </div>
    </div>
    <script>
        document.getElementById('uploadForm').onsubmit = function() {
            // Показать индикатор загрузки
            document.getElementById('loadingIndicator').style.display = 'block';

            // Отключить кнопку отправки, чтобы избежать повторной отправки
            document.querySelector('button[type="submit"]').disabled = true;
        };

        document.addEventListener("DOMContentLoaded", function () {
            const selectLifetime = document.getElementById("file_lifetime");
            const oneTimeNotice = document.getElementById("oneTimeNotice");

            function toggleOneTimeNotice() {
                if (selectLifetime.value === "one_time") {
                    oneTimeNotice.style.display = "block";
                } else {
                    oneTimeNotice.style.display = "none";
                }
            }

            selectLifetime.addEventListener("change", toggleOneTimeNotice);
            toggleOneTimeNotice();

            const originalTitle = document.title;
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            const changeInterval = 100;
            const transitionDuration = 2000;
            const endDelay = 2000;

            function generateRandomCharacter() {
                return characters.charAt(Math.floor(Math.random() * characters.length));
            }

            function animateTitleToRandom(index = 0) {
                if (index < originalTitle.length) {
                    document.title = document.title.substring(0, index) + generateRandomCharacter() + originalTitle.substring(index + 1);
                    setTimeout(() => animateTitleToRandom(index + 1), changeInterval);
                } else {
                    animateTitleToOriginal(originalTitle.length - 1);
                }
            }

            function animateTitleToOriginal(index) {
                if (index >= 0) {
                    document.title = document.title.substring(0, index) + originalTitle.charAt(index) + document.title.substring(index + 1);
                    setTimeout(() => animateTitleToOriginal(index - 1), changeInterval);
                } else {
                    setTimeout(startCycle, transitionDuration + endDelay);
                }
            }

            function startCycle() {
                setTimeout(() => {
                    animateTitleToRandom();
                }, transitionDuration);
            }

            startCycle();
        });
    </script>
</body>

</html>